# 项目需求说明：VS Code 插件 + Chrome 插件（面向 ChatGPT 网页端的手动桥接）

## 目标
构建一个由两部分组成的本地工具链（VS Code 插件 + Chrome 插件），用于在**不使用 OpenAI API**的前提下，实现类似 Cursor 的“编辑器内协作式开发体验”，并与 ChatGPT 网页端进行**手动触发**的信息互通与文件/代码同步。

---

## 总体约束
- **禁止使用 OpenAI API**（不通过 OpenAI API 发送/接收内容）。
- 与 ChatGPT 网页端交互以**手动操作为主**：由用户显式点击按钮触发“拉取/推送/同步”，避免后台自动化。
- 需要支持“项目级”工作流，而不仅是单次对话。

---

## 组件与职责

### A. VS Code 插件（编辑器端）
#### A1. 网页聊天内容可见性（来自浏览器侧）
- 能在 VS Code 内“看到”从浏览器侧传来的 ChatGPT 网页内容（例如：用户手动截取的对话片段、页面状态信息等）。
- 这些内容需要可检索、可回溯（至少在当前会话或项目范围内保留历史）。

#### A2. 发消息能力（发往浏览器侧）
- VS Code 内可编辑并发送消息给浏览器端（由浏览器端决定如何展示/放入网页输入框）。
- 发送动作要求用户可控（例如点击发送按钮）。

#### A3. 同步代码能力（代码打包用于上传到 ChatGPT 网页端）
- 提供“同步代码/打包上传”功能，用于将本地项目代码按规则打包成适合上传/粘贴到 ChatGPT 网页端的形式。
- 目标是减少文件数量、保证结构清晰（例如能够分辨“哪个原文件对应哪段内容”）。
- 同步触发应为手动：用户点击同步按钮/命令后生成打包产物，用户再手动上传到网页端。

#### A4. 类 Cursor 的规划能力（任务规划 + 连续执行）
- 提供“规划/任务”机制：把开发工作拆成一系列任务（Task）。
- 任务应具备状态管理（例如：Todo / In Progress / Done）。
- 当用户标记某任务完成后，应能自动推进到下一任务，并生成/提示下一任务的工作输入（例如下一步提示模板、下一条要做的事情）。

#### A5. 自动处理 ChatGPT 生成的 ZIP（检测到 ZIP 链接后在 VS Code 打开）
- 当从浏览器侧接收到内容中包含“新生成的 ZIP 下载链接”时：
  - 能检测该链接；
  - 支持一键下载 ZIP；
  - 自动解压并在 VS Code 中打开/导入（例如打开为新工作区或在当前工作区中浏览）。

---

### B. Chrome 插件（浏览器端）
#### B1. 与 VS Code 插件通信
- Chrome 插件必须能与 VS Code 插件双向通信（本地桥接）。
- 支持在用户手动触发时：
  - 从网页端“Fetch”（抓取/截取）信息发送给 VS Code；
  - 从 VS Code 侧“Push”信息到浏览器端（例如显示、填入输入框等）。

#### B2. 手动“截取网页聊天内容”（核心能力）
- 提供一个明确的按钮/操作，让用户手动触发“截取 ChatGPT 网页某一部分内容”并发送到 VS Code。
- 该功能需要解决：如何定位/获取网页中的“assistant 回复内容”或“用户关注的片段”。
- 用户希望能够通过该机制把截取结果再喂给其他 AI/工具，用于改进插件逻辑。

#### B3. 手动同步网页上传文件（非自动）
- 能支持用户手动触发“修改/更新/同步 ChatGPT 网页端上传文件”的流程（不要求自动后台同步）。
- 例如：用户点击按钮后，进入一个明确的交互步骤，把某个本地打包产物作为上传目标。

#### B4. 检测网页状态
- 能检测并反馈网页状态信息给 VS Code（例如：当前是否在 ChatGPT 页面、输入框是否可用、是否存在上传区域、页面是否加载完成等）。
- 状态检测用于提升手动操作的可靠性（例如按钮可用/不可用提示、错误原因提示）。

#### B5. 半自动/辅助发送消息（用户触发）
- 支持用户点击按钮后，将 VS Code 发来的消息写入网页输入框或进行可控的发送辅助。
- 重点：保持“用户触发”的交互范式。

---

## 用户关注点（验收重点）
1. **手动 Fetch / Push 的按钮化流程**：用户希望通过按钮完成“从网页取内容 / 向网页推内容”，而不是全自动。
2. **能在 VS Code 内集中查看网页对话片段**：形成开发协作闭环（对话→任务→代码→再对话）。
3. **同步代码可控且结构清楚**：打包后 ChatGPT 能理解“每段内容属于哪个原文件”。
4. **规划/状态机体验接近 Cursor**：Done → Next 连续推进，减少手动切换成本。
5. **ZIP 链接到 VS Code 的闭环**：检测→下载→解压→打开，降低内容导入成本。
6. **不使用 OpenAI API**：与 ChatGPT 网页端的集成通过浏览器侧与用户操作完成。

---

## 交付物
- 一个包含两部分的项目代码库：
  - VS Code 插件工程（可本地开发/打包安装）
  - Chrome 插件工程（可 Load unpacked 或打包发布）
- 配套的需求级文档（本 README）以及后续可能的开发说明与使用说明（可另行提供）。
