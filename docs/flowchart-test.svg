<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 900" font-family="system-ui, -apple-system, sans-serif">
  <!-- Background -->
  <rect width="800" height="900" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-size="20" font-weight="bold" fill="#1e293b">测试流程图 (Test Flow)</text>
  
  <!-- Start -->
  <ellipse cx="400" cy="80" rx="60" ry="25" fill="#10b981" stroke="#059669" stroke-width="2"/>
  <text x="400" y="85" text-anchor="middle" fill="white" font-size="12" font-weight="600">开始测试</text>
  
  <!-- Arrow 1 -->
  <line x1="400" y1="105" x2="400" y2="135" stroke="#374151" stroke-width="2" marker-end="url(#arrowF)"/>
  
  <defs>
    <marker id="arrowF" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>
  
  <!-- Phase 1: Install -->
  <rect x="100" y="140" width="600" height="120" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="120" y="165" fill="#1e40af" font-size="14" font-weight="bold">Phase 1: 安装</text>
  
  <rect x="130" y="180" width="240" height="60" rx="6" fill="white" stroke="#93c5fd" stroke-width="1"/>
  <text x="250" y="200" text-anchor="middle" fill="#1e40af" font-size="11" font-weight="600">VS Code 扩展</text>
  <text x="250" y="220" text-anchor="middle" fill="#64748b" font-size="10">cd src/vscode-extension</text>
  <text x="250" y="232" text-anchor="middle" fill="#64748b" font-size="10">npm install → npm run compile</text>
  
  <rect x="430" y="180" width="240" height="60" rx="6" fill="white" stroke="#93c5fd" stroke-width="1"/>
  <text x="550" y="200" text-anchor="middle" fill="#1e40af" font-size="11" font-weight="600">Chrome 扩展</text>
  <text x="550" y="220" text-anchor="middle" fill="#64748b" font-size="10">chrome://extensions</text>
  <text x="550" y="232" text-anchor="middle" fill="#64748b" font-size="10">加载 src/chrome-extension/</text>
  
  <!-- Arrow 2 -->
  <line x1="400" y1="260" x2="400" y2="290" stroke="#374151" stroke-width="2" marker-end="url(#arrowF)"/>
  
  <!-- Phase 2: Connect -->
  <rect x="100" y="295" width="600" height="100" rx="10" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="120" y="320" fill="#92400e" font-size="14" font-weight="bold">Phase 2: 连接</text>
  
  <rect x="130" y="335" width="160" height="45" rx="6" fill="white" stroke="#fcd34d" stroke-width="1"/>
  <text x="210" y="355" text-anchor="middle" fill="#92400e" font-size="10" font-weight="600">1. VS Code: Start Server</text>
  <text x="210" y="368" text-anchor="middle" fill="#64748b" font-size="9">Cmd+Shift+P → Start</text>
  
  <text x="315" y="357" fill="#92400e" font-size="16">→</text>
  
  <rect x="340" y="335" width="160" height="45" rx="6" fill="white" stroke="#fcd34d" stroke-width="1"/>
  <text x="420" y="355" text-anchor="middle" fill="#92400e" font-size="10" font-weight="600">2. Chrome: 设置 Token</text>
  <text x="420" y="368" text-anchor="middle" fill="#64748b" font-size="9">Popup → Connect</text>
  
  <text x="525" y="357" fill="#92400e" font-size="16">→</text>
  
  <rect x="550" y="335" width="120" height="45" rx="6" fill="white" stroke="#fcd34d" stroke-width="1"/>
  <text x="610" y="355" text-anchor="middle" fill="#92400e" font-size="10" font-weight="600">3. Connect</text>
  <text x="610" y="368" text-anchor="middle" fill="#64748b" font-size="9">点击 Connect</text>
  
  <!-- Arrow 3 -->
  <line x1="400" y1="395" x2="400" y2="425" stroke="#374151" stroke-width="2" marker-end="url(#arrowF)"/>
  
  <!-- Decision: Connected? -->
  <polygon points="400,430 480,470 400,510 320,470" fill="#fef9c3" stroke="#eab308" stroke-width="2"/>
  <text x="400" y="465" text-anchor="middle" fill="#854d0e" font-size="11" font-weight="600">Connected?</text>
  <text x="400" y="480" text-anchor="middle" fill="#854d0e" font-size="10">状态显示绿色?</text>
  
  <!-- No branch -->
  <line x1="320" y1="470" x2="200" y2="470" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowF)"/>
  <text x="260" y="462" fill="#dc2626" font-size="10">No</text>
  <rect x="100" y="450" width="100" height="40" rx="6" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/>
  <text x="150" y="465" text-anchor="middle" fill="#dc2626" font-size="10" font-weight="600">检查:</text>
  <text x="150" y="480" text-anchor="middle" fill="#dc2626" font-size="9">端口/Token/防火墙</text>
  <line x1="150" y1="450" x2="150" y2="360" stroke="#ef4444" stroke-width="1" stroke-dasharray="4,2"/>
  <line x1="150" y1="360" x2="210" y2="360" stroke="#ef4444" stroke-width="1" stroke-dasharray="4,2" marker-end="url(#arrowF)"/>
  
  <!-- Yes branch -->
  <line x1="400" y1="510" x2="400" y2="540" stroke="#10b981" stroke-width="2" marker-end="url(#arrowF)"/>
  <text x="410" y="528" fill="#059669" font-size="10">Yes</text>
  
  <!-- Phase 3: Test Features -->
  <rect x="100" y="545" width="600" height="180" rx="10" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
  <text x="120" y="570" fill="#047857" font-size="14" font-weight="bold">Phase 3: 功能测试</text>
  
  <!-- Test boxes -->
  <rect x="120" y="585" width="170" height="55" rx="6" fill="white" stroke="#6ee7b7" stroke-width="1"/>
  <text x="205" y="602" text-anchor="middle" fill="#047857" font-size="10" font-weight="600">Test A: Capture Selection</text>
  <text x="205" y="616" text-anchor="middle" fill="#64748b" font-size="9">1. 在 ChatGPT 选中文字</text>
  <text x="205" y="628" text-anchor="middle" fill="#64748b" font-size="9">2. 点击 "Capture Selection"</text>
  
  <rect x="310" y="585" width="170" height="55" rx="6" fill="white" stroke="#6ee7b7" stroke-width="1"/>
  <text x="395" y="602" text-anchor="middle" fill="#047857" font-size="10" font-weight="600">Test B: Last Assistant</text>
  <text x="395" y="616" text-anchor="middle" fill="#64748b" font-size="9">1. 确保有 AI 回复</text>
  <text x="395" y="628" text-anchor="middle" fill="#64748b" font-size="9">2. 点击 "Capture Last"</text>
  
  <rect x="500" y="585" width="170" height="55" rx="6" fill="white" stroke="#6ee7b7" stroke-width="1"/>
  <text x="585" y="602" text-anchor="middle" fill="#047857" font-size="10" font-weight="600">Test C: Pick Bubble</text>
  <text x="585" y="616" text-anchor="middle" fill="#64748b" font-size="9">1. 点击 "Pick a Message"</text>
  <text x="585" y="628" text-anchor="middle" fill="#64748b" font-size="9">2. 点击任意消息气泡</text>
  
  <rect x="120" y="650" width="170" height="55" rx="6" fill="white" stroke="#6ee7b7" stroke-width="1"/>
  <text x="205" y="667" text-anchor="middle" fill="#047857" font-size="10" font-weight="600">Test D: Bundle Code</text>
  <text x="205" y="681" text-anchor="middle" fill="#64748b" font-size="9">VS Code: Bundle Workspace</text>
  <text x="205" y="693" text-anchor="middle" fill="#64748b" font-size="9">检查生成的 .md 文件</text>
  
  <rect x="310" y="650" width="170" height="55" rx="6" fill="white" stroke="#6ee7b7" stroke-width="1"/>
  <text x="395" y="667" text-anchor="middle" fill="#047857" font-size="10" font-weight="600">Test E: Push to Chat</text>
  <text x="395" y="681" text-anchor="middle" fill="#64748b" font-size="9">VS Code Panel: 输入文字</text>
  <text x="395" y="693" text-anchor="middle" fill="#64748b" font-size="9">点击 Push → 检查 Composer</text>
  
  <rect x="500" y="650" width="170" height="55" rx="6" fill="white" stroke="#6ee7b7" stroke-width="1"/>
  <text x="585" y="667" text-anchor="middle" fill="#047857" font-size="10" font-weight="600">Test F: Task Machine</text>
  <text x="585" y="681" text-anchor="middle" fill="#64748b" font-size="9">创建 Task → 标记完成</text>
  <text x="585" y="693" text-anchor="middle" fill="#64748b" font-size="9">检查状态自动切换</text>
  
  <!-- Arrow 4 -->
  <line x1="400" y1="725" x2="400" y2="755" stroke="#374151" stroke-width="2" marker-end="url(#arrowF)"/>
  
  <!-- Decision: All Pass? -->
  <polygon points="400,760 480,800 400,840 320,800" fill="#fef9c3" stroke="#eab308" stroke-width="2"/>
  <text x="400" y="795" text-anchor="middle" fill="#854d0e" font-size="11" font-weight="600">All Pass?</text>
  <text x="400" y="810" text-anchor="middle" fill="#854d0e" font-size="10">全部通过?</text>
  
  <!-- No branch -->
  <line x1="480" y1="800" x2="600" y2="800" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowF)"/>
  <text x="540" y="792" fill="#dc2626" font-size="10">No</text>
  <rect x="600" y="780" width="100" height="40" rx="6" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/>
  <text x="650" y="798" text-anchor="middle" fill="#dc2626" font-size="10" font-weight="600">Debug</text>
  <text x="650" y="812" text-anchor="middle" fill="#dc2626" font-size="9">检查 Console</text>
  
  <!-- Yes branch -->
  <line x1="400" y1="840" x2="400" y2="870" stroke="#10b981" stroke-width="2" marker-end="url(#arrowF)"/>
  <text x="410" y="858" fill="#059669" font-size="10">Yes</text>
  
  <!-- End -->
  <ellipse cx="400" cy="890" rx="60" ry="20" fill="#10b981" stroke="#059669" stroke-width="2"/>
  <text x="400" y="895" text-anchor="middle" fill="white" font-size="11" font-weight="600">✓ 测试完成</text>
</svg>

